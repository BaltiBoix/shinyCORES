add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
color=toRGB(lcol[i-1], alpha=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", color=toRGB(lcol[i-1], alpha=0.5))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
color=toRGB(lcol[i-1], alpha=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", color=toRGB(lcol[i-1], alpha=0.5))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
colour=toRGB(lcol[i-1], alpha=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", colour=toRGB(lcol[i-1], alpha=0.5))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
fillcolor=toRGB(lcol[i-1], alpha=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", fillcolor=toRGB(lcol[i-1], alpha=0.5))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
?plot_ly
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=toRGB(lcol[i-1], alpha=1.0))) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", fillcolor=toRGB(lcol[i-1], alpha=0.5))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=toRGB(lcol[i-1], alpha=1.0))) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=toRGB(lcol[i-1], alpha=1.0)))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=toRGB(lcol[i-1], alpha=1.0))) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=toRGB(lcol[i-1], alpha=0.5)))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=toRGB(lcol[i-1], alpha=1.0), width=0.5)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=toRGB(lcol[i-1], alpha=0.5), width=1.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=toRGB(lcol[i-1], alpha=1.0), width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=toRGB(lcol[i-1], alpha=0.5), width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
p
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=toRGB(lcol[i-1], alpha=1.0), width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=toRGB(lcol[i-1], alpha=0.5), width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
colors()
?colors
rainbow(10)
colors(TRUE)
jBrewColors <- brewer.pal(n = 8, name = "Dark2")
install.packages("RColorBrewer")
library(RColorBrewer)
jBrewColors <- brewer.pal(n = 8, name = "Dark2")
jBrewColors
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=toRGB(lcol[i-1], alpha=0.5), width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
source('~/RProjects/PlotlyCORES/PlotlyCORES.R', encoding = 'UTF-8', echo=TRUE)
lcol<-c("red", "blue", "green", "brown", "cyan", "orange")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=toRGB(lcol[i-1], alpha=0.5), width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
jBrewColors <- brewer.pal(n = 10, name = "Dark2")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i-1], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
jBrewColors <- brewer.pal(n = 10, name = "Dark2")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i-1], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
?brewer.pal
display.brewer.pal(n = 8, name = "Dark2")
display.brewer.pal(n = 10, name = "Dark2")
display.brewer.pal(n = 12, name = "Paired")
jBrewColors <- brewer.pal(n = 12, name = "Paired")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
jBrewColors <- brewer.pal(n = 12, name = "Paired")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
display.brewer.pal(n = 8, name = "Accent")
display.brewer.pal(n = 8, name = "Set1")
display.brewer.pal(n = 8, name = "Set2")
display.brewer.pal(n = 8, name = "Set3")
jBrewColors <- brewer.pal(n = 9, name = "Set1")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i-1], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
jBrewColors <- brewer.pal(n = 9, name = "Set1")
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i-1], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
source('~/RProjects/shinyCORES/global.R')
shiny::runApp()
runApp()
runApp()
print(i)
print(paste("i", i))
runApp()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i-1], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i-1], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title="Total España")
p
p <- plot_ly()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- p %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
showlegend=FALSE, hoverinfo = "none", line=list(color=jBrewColors[i-1], width=2.0))
}
p<-p %>% layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.25, gridcolor = toRGB("red", alpha=0.25)),
title=paste0(CCAA.Sel, "-", Provincia.Sel))
p
runApp()
runApp()
length(l)
l<-list()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- plot_ly() %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i])) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
name=paste("trend",names(zdf[i])), showlegend=FALSE, hoverinfo = "none") %>%
layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title="Total España")
l[[i-1]]<-p
}
subplot(l, nrows = 2, shareX = TRUE, shareY = TRUE)
length(l)
runApp()
subplot(l, nrows = ncol(zdf)-1, shareX = TRUE, shareY = TRUE)
CCAAA.Sel<-"Total"
Provincia.Sel<-"España"
print(names(zdf))
l<-list()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- plot_ly() %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
name=paste("trend",names(zdf[i])), showlegend=FALSE, hoverinfo = "none",
line=list(color=jBrewColors[i-1], width=2.0)) %>%
layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title=paste0(CCAA.Sel, "-", Provincia.Sel))
l[[i-1]]<-p
}
print(length(l))
subplot(l, nrows = ncol(zdf)-1, shareX = TRUE, shareY = TRUE)
p
CCAA.Sel<-"Total"
print(names(zdf))
l<-list()
for(i in 2:length(zdf)){
tsi<-ts(zdf[,i], frequency=12, start =c(as.numeric(format(index(z[1,1]), "%Y")), as.numeric(format(index(z[1,1]), "%m"))))
trend<-stl(tsi, "per")$time.series[, 2]
p <- plot_ly() %>%
add_lines(x=zdf[,1], y=zdf[,i], type="scatter", mode = "lines", name=names(zdf[i]),
line=list(color=jBrewColors[i-1], width=1.0)) %>%
add_lines(x=zdf[,1], y=coredata(trend), type="scatter", mode = "lines",
name=paste("trend",names(zdf[i])), showlegend=FALSE, hoverinfo = "none",
line=list(color=jBrewColors[i-1], width=2.0)) %>%
layout(xaxis=list(title="Fecha", type="date", showline=TRUE, showgrid=TRUE,
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
yaxis=list(title="kt/mes", type="linear", showline=TRUE, showgrid=TRUE,
exponentformat="SI",
tickwidth=1, mirror = TRUE,
gridwidth=0.5, gridcolor = toRGB("red", alpha=0.5)),
title=paste0(CCAA.Sel, "-", Provincia.Sel))
l[[i-1]]<-p
}
print(length(l))
subplot(l, nrows = ncol(zdf)-1, shareX = TRUE, shareY = TRUE)
p
runApp()
runApp()
?sapply
